<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" id="Definitions_RegisterCustomer" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="5.41.0">
  <bpmn:process id="RegisterCustomer" name="Đăng ký Khách hàng" isExecutable="true">
    <bpmn:startEvent id="StartEvent_Register" name="Bắt đầu đăng ký">
      <bpmn:outgoing>Flow_1</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:serviceTask id="Task_CheckOwner" name="Kiểm tra quyền Owner">
      <bpmn:incoming>Flow_1</bpmn:incoming>
      <bpmn:outgoing>Flow_2</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:exclusiveGateway id="Gateway_IsOwner" name="Là Owner?">
      <bpmn:incoming>Flow_2</bpmn:incoming>
      <bpmn:outgoing>Flow_Yes_Owner</bpmn:outgoing>
      <bpmn:outgoing>Flow_No_Owner</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:endEvent id="EndEvent_NotOwner" name="Không có quyền">
      <bpmn:incoming>Flow_No_Owner</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:serviceTask id="Task_CheckAlreadyRegistered" name="Kiểm tra đã đăng ký">
      <bpmn:incoming>Flow_Yes_Owner</bpmn:incoming>
      <bpmn:outgoing>Flow_3</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:exclusiveGateway id="Gateway_AlreadyRegistered" name="Đã đăng ký?">
      <bpmn:incoming>Flow_3</bpmn:incoming>
      <bpmn:outgoing>Flow_Yes_Registered</bpmn:outgoing>
      <bpmn:outgoing>Flow_No_Registered</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:endEvent id="EndEvent_AlreadyRegistered" name="Đã đăng ký rồi">
      <bpmn:incoming>Flow_Yes_Registered</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:serviceTask id="Task_RegisterOnChain" name="Ghi nhận đăng ký trên Blockchain (registerCustomer)">
      <bpmn:incoming>Flow_No_Registered</bpmn:incoming>
      <bpmn:outgoing>Flow_1f1j9ip</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:intermediateThrowEvent id="Event_CustomerRegistered" name="Sự kiện: CustomerRegistered">
      <bpmn:incoming>Flow_1f1j9ip</bpmn:incoming>
      <bpmn:outgoing>Flow_5</bpmn:outgoing>
    </bpmn:intermediateThrowEvent>
    <bpmn:endEvent id="EndEvent_RegisterComplete" name="Đăng ký thành công">
      <bpmn:incoming>Flow_5</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_1" sourceRef="StartEvent_Register" targetRef="Task_CheckOwner" />
    <bpmn:sequenceFlow id="Flow_2" sourceRef="Task_CheckOwner" targetRef="Gateway_IsOwner" />
    <bpmn:sequenceFlow id="Flow_Yes_Owner" name="Là Owner" sourceRef="Gateway_IsOwner" targetRef="Task_CheckAlreadyRegistered" />
    <bpmn:sequenceFlow id="Flow_No_Owner" name="Không phải Owner" sourceRef="Gateway_IsOwner" targetRef="EndEvent_NotOwner" />
    <bpmn:sequenceFlow id="Flow_3" sourceRef="Task_CheckAlreadyRegistered" targetRef="Gateway_AlreadyRegistered" />
    <bpmn:sequenceFlow id="Flow_Yes_Registered" name="Đã đăng ký" sourceRef="Gateway_AlreadyRegistered" targetRef="EndEvent_AlreadyRegistered" />
    <bpmn:sequenceFlow id="Flow_No_Registered" name="Chưa đăng ký" sourceRef="Gateway_AlreadyRegistered" targetRef="Task_RegisterOnChain" />
    <bpmn:sequenceFlow id="Flow_5" sourceRef="Event_CustomerRegistered" targetRef="EndEvent_RegisterComplete" />
    <bpmn:sequenceFlow id="Flow_1f1j9ip" sourceRef="Task_RegisterOnChain" targetRef="Event_CustomerRegistered" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_RegisterCustomer">
    <bpmndi:BPMNPlane id="BPMNPlane_RegisterCustomer" bpmnElement="RegisterCustomer">
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_Register" bpmnElement="StartEvent_Register">
        <dc:Bounds x="180" y="110" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="158" y="153" width="80" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_Task_CheckOwner" bpmnElement="Task_CheckOwner">
        <dc:Bounds x="260" y="88" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_Gateway_IsOwner" bpmnElement="Gateway_IsOwner" isMarkerVisible="true">
        <dc:Bounds x="400" y="103" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="398" y="79" width="54" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_EndEvent_NotOwner" bpmnElement="EndEvent_NotOwner">
        <dc:Bounds x="407" y="232" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="385" y="275" width="80" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_Task_CheckAlreadyRegistered" bpmnElement="Task_CheckAlreadyRegistered">
        <dc:Bounds x="530" y="88" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_Gateway_AlreadyRegistered" bpmnElement="Gateway_AlreadyRegistered" isMarkerVisible="true">
        <dc:Bounds x="655" y="103" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="649" y="79" width="62" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_EndEvent_AlreadyRegistered" bpmnElement="EndEvent_AlreadyRegistered">
        <dc:Bounds x="662" y="232" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="655" y="275" width="71" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_Task_RegisterOnChain" bpmnElement="Task_RegisterOnChain">
        <dc:Bounds x="800" y="88" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_Event_CustomerRegistered" bpmnElement="Event_CustomerRegistered">
        <dc:Bounds x="962" y="110" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="938" y="153" width="85" height="40" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_EndEvent_RegisterComplete" bpmnElement="EndEvent_RegisterComplete">
        <dc:Bounds x="1062" y="110" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1045" y="153" width="71" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1_di" bpmnElement="Flow_1">
        <di:waypoint x="216" y="128" />
        <di:waypoint x="260" y="128" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_2_di" bpmnElement="Flow_2">
        <di:waypoint x="360" y="128" />
        <di:waypoint x="400" y="128" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Yes_Owner_di" bpmnElement="Flow_Yes_Owner">
        <di:waypoint x="450" y="128" />
        <di:waypoint x="530" y="128" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="466" y="110" width="48" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_No_Owner_di" bpmnElement="Flow_No_Owner">
        <di:waypoint x="425" y="153" />
        <di:waypoint x="425" y="232" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="362" y="176" width="56" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_3_di" bpmnElement="Flow_3">
        <di:waypoint x="630" y="128" />
        <di:waypoint x="655" y="128" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Yes_Registered_di" bpmnElement="Flow_Yes_Registered">
        <di:waypoint x="680" y="153" />
        <di:waypoint x="680" y="232" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="622" y="188" width="56" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_No_Registered_di" bpmnElement="Flow_No_Registered">
        <di:waypoint x="705" y="128" />
        <di:waypoint x="800" y="128" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="715" y="111" width="70" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_5_di" bpmnElement="Flow_5">
        <di:waypoint x="998" y="128" />
        <di:waypoint x="1062" y="128" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1f1j9ip_di" bpmnElement="Flow_1f1j9ip">
        <di:waypoint x="900" y="128" />
        <di:waypoint x="962" y="128" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
