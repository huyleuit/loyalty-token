<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" id="Definitions_TransferFromTokens" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="5.41.0">
  <bpmn:process id="TransferFromTokens" name="Chuyển Token từ Người khác" isExecutable="true">
    <bpmn:startEvent id="StartEvent_TransferFrom" name="Yêu cầu chuyển token từ người khác">
      <bpmn:outgoing>Flow_TF1</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:serviceTask id="Task_CheckAllowance_TransferFrom" name="Kiểm tra allowance">
      <bpmn:incoming>Flow_TF1</bpmn:incoming>
      <bpmn:outgoing>Flow_TF2</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:exclusiveGateway id="Gateway_SufficientAllowance_TransferFrom" name="Đủ allowance?">
      <bpmn:incoming>Flow_TF2</bpmn:incoming>
      <bpmn:outgoing>Flow_Enough_Allowance</bpmn:outgoing>
      <bpmn:outgoing>Flow_NotEnough_Allowance</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:endEvent id="EndEvent_Insufficient_Allowance" name="Không đủ allowance">
      <bpmn:incoming>Flow_NotEnough_Allowance</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:serviceTask id="Task_CheckBalance_TransferFrom" name="Kiểm tra số dư của người gửi">
      <bpmn:incoming>Flow_Enough_Allowance</bpmn:incoming>
      <bpmn:outgoing>Flow_TF3</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:exclusiveGateway id="Gateway_SufficientBalance_TransferFrom" name="Đủ số dư?">
      <bpmn:incoming>Flow_TF3</bpmn:incoming>
      <bpmn:outgoing>Flow_Enough_Balance</bpmn:outgoing>
      <bpmn:outgoing>Flow_NotEnough_Balance</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:endEvent id="EndEvent_Insufficient_Balance" name="Không đủ số dư">
      <bpmn:incoming>Flow_NotEnough_Balance</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:serviceTask id="Task_TransferFromOnChain" name="Chuyển token trên Blockchain (transferFrom)">
      <bpmn:incoming>Flow_Enough_Balance</bpmn:incoming>
      <bpmn:outgoing>Flow_1dwrdv9</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:intermediateThrowEvent id="Event_TransferFrom" name="Sự kiện: Transfer">
      <bpmn:incoming>Flow_1dwrdv9</bpmn:incoming>
      <bpmn:outgoing>Flow_TF5</bpmn:outgoing>
    </bpmn:intermediateThrowEvent>
    <bpmn:endEvent id="EndEvent_TransferFromComplete" name="Chuyển token thành công">
      <bpmn:incoming>Flow_TF5</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_TF1" sourceRef="StartEvent_TransferFrom" targetRef="Task_CheckAllowance_TransferFrom" />
    <bpmn:sequenceFlow id="Flow_TF2" sourceRef="Task_CheckAllowance_TransferFrom" targetRef="Gateway_SufficientAllowance_TransferFrom" />
    <bpmn:sequenceFlow id="Flow_Enough_Allowance" name="Đủ allowance" sourceRef="Gateway_SufficientAllowance_TransferFrom" targetRef="Task_CheckBalance_TransferFrom" />
    <bpmn:sequenceFlow id="Flow_NotEnough_Allowance" name="Không đủ allowance" sourceRef="Gateway_SufficientAllowance_TransferFrom" targetRef="EndEvent_Insufficient_Allowance" />
    <bpmn:sequenceFlow id="Flow_TF3" sourceRef="Task_CheckBalance_TransferFrom" targetRef="Gateway_SufficientBalance_TransferFrom" />
    <bpmn:sequenceFlow id="Flow_Enough_Balance" name="Đủ số dư" sourceRef="Gateway_SufficientBalance_TransferFrom" targetRef="Task_TransferFromOnChain" />
    <bpmn:sequenceFlow id="Flow_NotEnough_Balance" name="Không đủ số dư" sourceRef="Gateway_SufficientBalance_TransferFrom" targetRef="EndEvent_Insufficient_Balance" />
    <bpmn:sequenceFlow id="Flow_TF5" sourceRef="Event_TransferFrom" targetRef="EndEvent_TransferFromComplete" />
    <bpmn:sequenceFlow id="Flow_1dwrdv9" sourceRef="Task_TransferFromOnChain" targetRef="Event_TransferFrom" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_TransferFromTokens">
    <bpmndi:BPMNPlane id="BPMNPlane_TransferFromTokens" bpmnElement="TransferFromTokens">
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_TransferFrom" bpmnElement="StartEvent_TransferFrom">
        <dc:Bounds x="180" y="110" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="159" y="153" width="79" height="40" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_Task_CheckAllowance_TransferFrom" bpmnElement="Task_CheckAllowance_TransferFrom">
        <dc:Bounds x="260" y="88" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_Gateway_SufficientBalance_TransferFrom" bpmnElement="Gateway_SufficientBalance_TransferFrom" isMarkerVisible="true">
        <dc:Bounds x="675" y="103" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="674" y="79" width="52" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_EndEvent_Insufficient_Balance" bpmnElement="EndEvent_Insufficient_Balance">
        <dc:Bounds x="682" y="222" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="661" y="265" width="79" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_Task_CheckBalance_TransferFrom" bpmnElement="Task_CheckBalance_TransferFrom">
        <dc:Bounds x="540" y="88" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_Task_TransferFromOnChain" bpmnElement="Task_TransferFromOnChain">
        <dc:Bounds x="820" y="88" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_EndEvent_TransferFromComplete" bpmnElement="EndEvent_TransferFromComplete">
        <dc:Bounds x="1082" y="110" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1066" y="153" width="68" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_Event_TransferFrom" bpmnElement="Event_TransferFrom">
        <dc:Bounds x="982" y="110" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="958" y="153" width="85" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_Gateway_SufficientAllowance_TransferFrom" bpmnElement="Gateway_SufficientAllowance_TransferFrom" isMarkerVisible="true">
        <dc:Bounds x="405" y="103" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="393" y="79" width="73" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_EndEvent_Insufficient_Allowance" bpmnElement="EndEvent_Insufficient_Allowance">
        <dc:Bounds x="412" y="222" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="406" y="265" width="49" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_TF1_di" bpmnElement="Flow_TF1">
        <di:waypoint x="216" y="128" />
        <di:waypoint x="260" y="128" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_TF2_di" bpmnElement="Flow_TF2">
        <di:waypoint x="360" y="128" />
        <di:waypoint x="405" y="128" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Enough_Allowance_di" bpmnElement="Flow_Enough_Allowance">
        <di:waypoint x="455" y="128" />
        <di:waypoint x="540" y="128" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="468" y="110" width="67" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_NotEnough_Allowance_di" bpmnElement="Flow_NotEnough_Allowance">
        <di:waypoint x="430" y="153" />
        <di:waypoint x="430" y="222" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="365" y="177" width="49" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_TF3_di" bpmnElement="Flow_TF3">
        <di:waypoint x="640" y="128" />
        <di:waypoint x="675" y="128" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_Enough_Balance_di" bpmnElement="Flow_Enough_Balance">
        <di:waypoint x="725" y="128" />
        <di:waypoint x="820" y="128" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="756.9999999999998" y="110" width="46" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_NotEnough_Balance_di" bpmnElement="Flow_NotEnough_Balance">
        <di:waypoint x="700" y="153" />
        <di:waypoint x="700" y="222" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="615" y="184" width="79" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1dwrdv9_di" bpmnElement="Flow_1dwrdv9">
        <di:waypoint x="920" y="128" />
        <di:waypoint x="982" y="128" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_TF5_di" bpmnElement="Flow_TF5">
        <di:waypoint x="1018" y="128" />
        <di:waypoint x="1082" y="128" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
